<script>
(function() {
  // Only add supplementary schema for blog posts
  if (!document.querySelector('article.quarto-post')) return;

  var title = document.querySelector('meta[property="og:title"]')?.content || document.title;

  // Breadcrumb schema (needs client-side URL parsing)
  var pathParts = window.location.pathname.split('/').filter(Boolean);
  if (pathParts.length >= 2) {
    var breadcrumb = {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        {
          "@type": "ListItem",
          "position": 1,
          "name": "Home",
          "item": "https://gfrm.in/"
        },
        {
          "@type": "ListItem",
          "position": 2,
          "name": "Posts",
          "item": "https://gfrm.in/posts/"
        },
        {
          "@type": "ListItem",
          "position": 3,
          "name": title
        }
      ]
    };

    var script = document.createElement('script');
    script.type = 'application/ld+json';
    script.text = JSON.stringify(breadcrumb);
    document.head.appendChild(script);
  }

  // Augment the server-side JSON-LD with wordCount (needs DOM access)
  var existing = document.querySelector('script[type="application/ld+json"]');
  if (existing) {
    try {
      var data = JSON.parse(existing.text);
      if (data["@type"] === "BlogPosting" && !data.wordCount) {
        var articleBody = document.querySelector('#quarto-content');
        if (articleBody) {
          data.wordCount = articleBody.textContent.trim().split(/\s+/).length;
          existing.text = JSON.stringify(data);
        }
      }
    } catch (e) {}
  }
})();
</script>
